BM 基础上进行优化